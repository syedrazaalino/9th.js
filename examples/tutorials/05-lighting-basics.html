<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 - Lighting Basics: Types and Effects</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }
        
        #canvas-container {
            width: 100vw;
            height: 100vh;
        }
        
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.85);
            padding: 18px;
            border-radius: 10px;
            max-width: 300px;
            line-height: 1.4;
            font-size: 12px;
        }
        
        h1 {
            margin: 0 0 12px 0;
            font-size: 18px;
            color: #f1c40f;
        }
        
        .step {
            margin: 8px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            border-left: 3px solid #f1c40f;
        }
        
        .light-demo {
            margin: 6px 0;
            padding: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            cursor: pointer;
            border-left: 3px solid;
            transition: background 0.2s;
        }
        
        .light-demo:hover { background: rgba(255, 255, 255, 0.2); }
        .light-demo.ambient { border-left-color: #3498db; }
        .light-demo.directional { border-left-color: #f39c12; }
        .light-demo.point { border-left-color: #e74c3c; }
        .light-demo.spot { border-left-color: #9b59b6; }
        .light-demo.hemisphere { border-left-color: #2ecc71; }
        
        .controls {
            margin-top: 12px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        
        .controls button {
            margin: 2px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-family: inherit;
            font-size: 11px;
        }
        
        .controls button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .controls button.active {
            background: #f39c12;
            border-color: #f39c12;
        }
        
        .light-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            font-size: 11px;
            line-height: 1.5;
        }
        
        code {
            background: rgba(0, 0, 0, 0.5);
            padding: 1px 4px;
            border-radius: 3px;
            color: #f1c40f;
        }
    </style>
</head>
<body>
    <div id="info">
        <h1>ðŸ’¡ Tutorial 05: Lighting</h1>
        <div class="step">
            <strong>Goal:</strong> Master different light types and their effects
        </div>
        <div class="step">
            <strong>Light Types:</strong>
            <div class="light-demo ambient" onclick="toggleLight('ambient')">
                <strong>Ambient</strong> - Overall illumination<br>
                <small>Like sunlight on a cloudy day</small>
            </div>
            <div class="light-demo directional" onclick="toggleLight('directional')">
                <strong>Directional</strong> - Sun-like parallel rays<br>
                <small>Parallel light, like the sun</small>
            </div>
            <div class="light-demo point" onclick="toggleLight('point')">
                <strong>Point</strong> - Light bulb effect<br>
                <small>Emits light in all directions</small>
            </div>
            <div class="light-demo spot" onclick="toggleLight('spot')">
                <strong>Spot</strong> - Flashlight cone<br>
                <small>Directional cone of light</small>
            </div>
            <div class="light-demo hemisphere" onclick="toggleLight('hemisphere')">
                <strong>Hemisphere</strong> - Sky/ground reflection<br>
                <small>Two-colored ambient light</small>
            </div>
        </div>
        <div class="controls">
            <strong>Scene Controls:</strong><br>
            <button id="toggle-shadows" onclick="toggleShadows()">Toggle Shadows</button><br>
            <button id="reset-lights" onclick="resetLights()">Reset Lights</button><br>
            <button id="animate-lights" onclick="animateLights()" class="active">Animate Lights</button>
        </div>
    </div>
    
    <div class="light-info">
        <strong>Active Lights:</strong> <span id="active-lights">3</span><br>
        <strong>Shadows:</strong> <span id="shadow-status">Enabled</span><br>
        <strong>Animation:</strong> <span id="animation-status">Running</span>
    </div>
    
    <div id="canvas-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <script>
        /**
         * ==========================================
         * TUTORIAL 05: LIGHTING BASICS
         * ==========================================
         * 
         * Lighting is crucial for creating realistic 3D scenes.
         * Different light types create different moods and effects.
         * 
         * LIGHT TYPES:
         * 1. AmbientLight - Even illumination from all directions
         * 2. DirectionalLight - Parallel rays (like the sun)
         * 3. PointLight - Light source that emits in all directions
         * 4. SpotLight - Conical beam of light
         * 5. HemisphereLight - Sky/ground color mixing
         */
        
        // ==========================================
        // GLOBAL VARIABLES
        // ==========================================
        let scene, camera, renderer;
        let lights = {};
        let lightHelpers = {};
        let animationId;
        let animationEnabled = true;
        let shadowEnabled = true;
        let objects = [];
        
        // ==========================================
        // BASIC SCENE SETUP
        // ==========================================
        function setupScene() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a1a);
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 8, 15);
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.outputEncoding = THREE.sRGBEncoding;
            
            document.getElementById('canvas-container').appendChild(renderer.domElement);
        }
        
        // ==========================================
        // CREATE TEST OBJECTS
        // ==========================================
        function createTestObjects() {
            // Create objects at different heights to show light falloff
            const positions = [
                { x: -6, y: 0, z: 0 },
                { x: -3, y: 2, z: -2 },
                { x: 0, y: 0, z: -4 },
                { x: 3, y: 3, z: -2 },
                { x: 6, y: 1, z: 0 }
            ];
            
            positions.forEach((pos, index) => {
                const geometry = new THREE.SphereGeometry(0.8, 16, 16);
                const material = new THREE.MeshStandardMaterial({ 
                    color: new THREE.Color().setHSL(index / positions.length, 0.7, 0.6),
                    roughness: 0.3,
                    metalness: 0.1
                });
                
                const sphere = new THREE.Mesh(geometry, material);
                sphere.position.set(pos.x, pos.y, pos.z);
                sphere.castShadow = true;
                sphere.receiveShadow = true;
                
                scene.add(sphere);
                objects.push(sphere);
            });
            
            // Add a torus knot for complex shadows
            const torusGeometry = new THREE.TorusKnotGeometry(0.5, 0.2, 100, 16);
            const torusMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x8b5cf6,
                roughness: 0.2,
                metalness: 0.8
            });
            const torus = new THREE.Mesh(torusGeometry, torusMaterial);
            torus.position.set(0, -2, -4);
            torus.castShadow = true;
            scene.add(torus);
            objects.push(torus);
            
            // Ground plane
            const groundGeometry = new THREE.PlaneGeometry(20, 20);
            const groundMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x333333,
                roughness: 0.8
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);
        }
        
        // ==========================================
        // CREATE DIFFERENT LIGHT TYPES
        // ==========================================
        function createLights() {
            // 1. Ambient Light - Base illumination
            lights.ambient = new THREE.AmbientLight(0x404040, 0.3);
            scene.add(lights.ambient);
            
            // 2. Directional Light - Sun-like
            lights.directional = new THREE.DirectionalLight(0xffffff, 0.8);
            lights.directional.position.set(5, 10, 5);
            lights.directional.castShadow = true;
            lights.directional.shadow.mapSize.width = 1024;
            lights.directional.shadow.mapSize.height = 1024;
            lights.directional.shadow.camera.near = 0.5;
            lights.directional.shadow.camera.far = 50;
            lights.directional.shadow.camera.left = -10;
            lights.directional.shadow.camera.right = 10;
            lights.directional.shadow.camera.top = 10;
            lights.directional.shadow.camera.bottom = -10;
            scene.add(lights.directional);
            
            // 3. Point Light - Light bulb
            lights.point = new THREE.PointLight(0xff6b6b, 1, 20);
            lights.point.position.set(0, 5, 5);
            lights.point.castShadow = true;
            lights.point.shadow.mapSize.width = 512;
            lights.point.shadow.mapSize.height = 512;
            scene.add(lights.point);
            
            // 4. Spot Light - Flashlight cone
            lights.spot = new THREE.SpotLight(0x9b59b6, 0.8, 30, Math.PI / 6, 0.3);
            lights.spot.position.set(-5, 8, 8);
            lights.spot.castShadow = true;
            lights.spot.shadow.mapSize.width = 512;
            lights.spot.shadow.mapSize.height = 512;
            scene.add(lights.spot);
            lights.spot.target.position.set(0, 0, 0);
            scene.add(lights.spot.target);
            
            // 5. Hemisphere Light - Sky/ground colors
            lights.hemisphere = new THREE.HemisphereLight(0x87ceeb, 0x8b4513, 0.4);
            scene.add(lights.hemisphere);
            
            // Add light helpers for visualization
            createLightHelpers();
        }
        
        // ==========================================
        // LIGHT HELPERS (VISUAL AIDS)
        // ==========================================
        function createLightHelpers() {
            // Directional light helper
            lightHelpers.directional = new THREE.DirectionalLightHelper(lights.directional, 1);
            
            // Point light helper
            lightHelpers.point = new THREE.PointLightHelper(lights.point, 0.5);
            
            // Spot light helper
            lightHelpers.spot = new THREE.SpotLightHelper(lights.spot);
            
            Object.values(lightHelpers).forEach(helper => {
                scene.add(helper);
            });
        }
        
        // ==========================================
        // LIGHT TOGGLE FUNCTIONS
        // ==========================================
        function toggleLight(lightType) {
            const light = lights[lightType];
            if (light) {
                light.visible = !light.visible;
                if (lightHelpers[lightType]) {
                    lightHelpers[lightType].visible = light.visible;
                }
                updateLightInfo();
            }
        }
        
        // ==========================================
        // SCENE CONTROL FUNCTIONS
        // ==========================================
        function toggleShadows() {
            shadowEnabled = !shadowEnabled;
            Object.values(lights).forEach(light => {
                if (light.shadow) {
                    light.castShadow = shadowEnabled;
                }
            });
            
            renderer.shadowMap.enabled = shadowEnabled;
            document.getElementById('shadow-status').textContent = 
                shadowEnabled ? 'Enabled' : 'Disabled';
        }
        
        function resetLights() {
            // Reset light positions and properties
            lights.directional.position.set(5, 10, 5);
            lights.point.position.set(0, 5, 5);
            lights.spot.position.set(-5, 8, 8);
            lights.spot.angle = Math.PI / 6;
            
            Object.values(lights).forEach(light => {
                if (!light.visible) {
                    light.visible = true;
                }
            });
            
            updateLightInfo();
        }
        
        function animateLights() {
            animationEnabled = !animationEnabled;
            document.getElementById('animation-status').textContent = 
                animationEnabled ? 'Running' : 'Stopped';
        }
        
        // ==========================================
        // UPDATE LIGHT INFORMATION
        // ==========================================
        function updateLightInfo() {
            const activeCount = Object.values(lights).filter(light => light.visible).length;
            document.getElementById('active-lights').textContent = activeCount;
        }
        
        // ==========================================
        // ANIMATION LOOP
        // ==========================================
        function animate() {
            animationId = requestAnimationFrame(animate);
            
            const time = Date.now() * 0.001;
            
            // Animate objects
            objects.forEach((obj, index) => {
                obj.rotation.x += 0.01;
                obj.rotation.y += 0.02;
            });
            
            // Animate lights if enabled
            if (animationEnabled) {
                // Move point light in a circle
                lights.point.position.x = Math.cos(time * 0.5) * 5;
                lights.point.position.z = Math.sin(time * 0.5) * 5;
                lights.point.position.y = 3 + Math.sin(time * 2) * 2;
                
                // Move spot light
                lights.spot.position.x = Math.sin(time * 0.3) * 8;
                lights.spot.position.z = Math.cos(time * 0.3) * 8;
                
                // Update spot light target to look at center
                lights.spot.target.position.set(
                    Math.sin(time * 0.2) * 2,
                    0,
                    Math.cos(time * 0.2) * 2
                );
                lights.spot.target.updateMatrixWorld();
                
                // Update helpers
                if (lightHelpers.point) {
                    lightHelpers.point.update();
                }
                if (lightHelpers.spot) {
                    lightHelpers.spot.update();
                }
            }
            
            renderer.render(scene, camera);
        }
        
        // ==========================================
        // RESIZE HANDLING
        // ==========================================
        function handleResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // ==========================================
        // INITIALIZATION
        // ==========================================
        function init() {
            console.log('ðŸ’¡ Starting Lighting Demo...');
            
            setupScene();
            createTestObjects();
            createLights();
            updateLightInfo();
            
            window.addEventListener('resize', handleResize);
            animate();
            
            console.log('âœ… Lighting demo initialized!');
        }
        
        // Make functions globally available
        window.toggleLight = toggleLight;
        window.toggleShadows = toggleShadows;
        window.resetLights = resetLights;
        window.animateLights = animateLights;
        
        init();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Art Gallery</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f5dc 0%, #e6e6fa 25%, #f0f8ff 50%, #faf0e6 75%, #f5f5dc 100%);
        }

        #canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }

        .gallery-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            color: #333;
            min-width: 320px;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(139, 69, 19, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            max-height: 85vh;
            overflow-y: auto;
        }

        .gallery-ui h1 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 26px;
            color: #8b4513;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-bottom: 3px solid rgba(139, 69, 19, 0.3);
            padding-bottom: 10px;
            font-weight: bold;
        }

        .gallery-section {
            margin-bottom: 25px;
        }

        .gallery-section h3 {
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid rgba(139, 69, 19, 0.2);
            padding-bottom: 8px;
            font-weight: 600;
        }

        .exhibition-types {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .exhibition-btn {
            padding: 12px 10px;
            border: 2px solid #8b4513;
            border-radius: 12px;
            background: rgba(139, 69, 19, 0.1);
            color: #333;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .exhibition-btn:hover {
            background: rgba(139, 69, 19, 0.2);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.3);
            transform: translateY(-2px);
        }

        .exhibition-btn.active {
            background: rgba(139, 69, 19, 0.3);
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
            transform: translateY(-3px);
        }

        .artwork-section {
            margin-bottom: 20px;
        }

        .artwork-section h4 {
            color: #8b4513;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
        }

        .artwork-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .artwork-btn {
            padding: 8px 4px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: rgba(221, 221, 221, 0.5);
            color: #333;
            cursor: pointer;
            font-size: 10px;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .artwork-btn:hover {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.2);
        }

        .artwork-btn.active {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.3);
            box-shadow: 0 3px 10px rgba(139, 69, 19, 0.2);
        }

        .frame-section {
            margin-bottom: 20px;
        }

        .frame-section h4 {
            color: #8b4513;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
        }

        .frame-styles {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }

        .frame-btn {
            padding: 8px 6px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: rgba(221, 221, 221, 0.5);
            color: #333;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .frame-btn:hover {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.2);
        }

        .frame-btn.active {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.3);
            box-shadow: 0 3px 10px rgba(139, 69, 19, 0.2);
        }

        .lighting-section {
            margin-bottom: 20px;
        }

        .lighting-section h4 {
            color: #8b4513;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
        }

        .lighting-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .lighting-btn {
            padding: 8px 6px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: rgba(221, 221, 221, 0.5);
            color: #333;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .lighting-btn:hover {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.2);
        }

        .lighting-btn.active {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.3);
            box-shadow: 0 3px 10px rgba(139, 69, 19, 0.2);
        }

        .atmosphere-controls {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid rgba(139, 69, 19, 0.2);
        }

        .atmosphere-controls h3 {
            color: #8b4513;
            margin-bottom: 20px;
            font-size: 18px;
            text-align: center;
            font-weight: 600;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #8b4513;
            font-size: 14px;
            font-weight: 600;
        }

        .control-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .control-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #8b4513;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(139, 69, 19, 0.3);
        }

        .control-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #8b4513;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(139, 69, 19, 0.3);
        }

        .control-value {
            text-align: right;
            color: #8b4513;
            font-size: 12px;
            margin-top: 4px;
            font-weight: 600;
        }

        .gallery-presets {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .preset-btn {
            padding: 12px 8px;
            border: 2px solid #8b4513;
            border-radius: 10px;
            background: rgba(139, 69, 19, 0.1);
            color: #333;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            font-weight: 600;
            text-align: center;
        }

        .preset-btn:hover {
            background: rgba(139, 69, 19, 0.2);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.3);
            transform: translateY(-2px);
        }

        .scene-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 15px 20px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border: 2px solid rgba(139, 69, 19, 0.3);
            backdrop-filter: blur(10px);
        }

        .exhibition-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid rgba(139, 69, 19, 0.3);
            backdrop-filter: blur(10px);
            max-width: 300px;
        }

        .exhibition-info h4 {
            color: #8b4513;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 600;
        }

        .exhibition-detail {
            margin-bottom: 5px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }

        .detail-label {
            font-weight: bold;
            color: #8b4513;
        }

        .artwork-count {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .count-item {
            text-align: center;
            padding: 8px;
            background: rgba(139, 69, 19, 0.1);
            border-radius: 8px;
            font-size: 11px;
        }

        .count-number {
            font-size: 16px;
            font-weight: bold;
            color: #8b4513;
        }

        @media (max-width: 768px) {
            .gallery-ui {
                width: 280px;
                left: 10px;
                top: 10px;
                padding: 15px;
            }
            
            .exhibition-types,
            .frame-styles,
            .lighting-options,
            .gallery-presets {
                grid-template-columns: 1fr;
            }
            
            .artwork-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .artwork-count {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="gallery-ui">
        <h1>üé® Virtual Art Gallery</h1>
        
        <div class="gallery-section">
            <h3>Exhibition Type</h3>
            <div class="exhibition-types">
                <button class="exhibition-btn active" data-exhibition="classical">Classical</button>
                <button class="exhibition-btn" data-exhibition="modern">Modern</button>
                <button class="exhibition-btn" data-exhibition="contemporary">Contemporary</button>
                <button class="exhibition-btn" data-exhibition="abstract">Abstract</button>
                <button class="exhibition-btn" data-exhibition="impressionist">Impressionist</button>
                <button class="exhibition-btn" data-exhibition="sculpture">Sculpture Garden</button>
            </div>
        </div>

        <div class="artwork-section">
            <h4>Featured Artworks</h4>
            <div class="artwork-grid" id="artworkGrid">
                <div class="artwork-btn active" data-artwork="painting-1">Portrait</div>
                <div class="artwork-btn" data-artwork="painting-2">Landscape</div>
                <div class="artwork-btn" data-artwork="painting-3">Still Life</div>
                <div class="artwork-btn" data-artwork="painting-4">Abstract</div>
                <div class="artwork-btn" data-artwork="painting-5">Seascape</div>
                <div class="artwork-btn" data-artwork="painting-6">Cityscape</div>
            </div>
        </div>

        <div class="frame-section">
            <h4>Frame Style</h4>
            <div class="frame-styles">
                <div class="frame-btn active" data-frame="gold">Gold Leaf</div>
                <div class="frame-btn" data-frame="silver">Silver</div>
                <div class="frame-btn" data-frame="wood">Dark Wood</div>
                <div class="frame-btn" data-frame="black">Black Lacquer</div>
                <div class="frame-btn" data-frame="white">White</div>
                <div class="frame-btn" data-frame="ornate">Ornate</div>
            </div>
        </div>

        <div class="lighting-section">
            <h4>Gallery Lighting</h4>
            <div class="lighting-options">
                <div class="lighting-btn active" data-lighting="spotlight">Spotlight</div>
                <div class="lighting-btn" data-lighting="track">Track Lighting</div>
                <div class="lighting-btn" data-lighting="track">Natural Light</div>
                <div class="lighting-btn" data-lighting="ambient">Ambient</div>
            </div>
        </div>

        <div class="atmosphere-controls">
            <h3>üñºÔ∏è Gallery Atmosphere</h3>
            
            <div class="control-group">
                <label>Spotlight Intensity:</label>
                <input type="range" class="control-slider" id="spotlightIntensity" min="0" max="150" value="100">
                <div class="control-value" id="spotlightValue">100%</div>
            </div>

            <div class="control-group">
                <label>Ambient Light:</label>
                <input type="range" class="control-slider" id="ambientIntensity" min="0" max="80" value="30">
                <div class="control-value" id="ambientValue">30%</div>
            </div>

            <div class="control-group">
                <label>Fill Light:</label>
                <input type="range" class="control-slider" id="fillIntensity" min="0" max="60" value="20">
                <div class="control-value" id="fillValue">20%</div>
            </div>

            <div class="control-group">
                <label>Gallery Glow:</label>
                <input type="range" class="control-slider" id="galleryIntensity" min="0" max="40" value="15">
                <div class="control-value" id="galleryValue">15%</div>
            </div>

            <div class="gallery-presets">
                <button class="preset-btn" onclick="setGalleryPreset('museum')">Museum</button>
                <button class="preset-btn" onclick="setGalleryPreset('intimate')">Intimate</button>
                <button class="preset-btn" onclick="setGalleryPreset('dramatic')">Dramatic</button>
                <button class="preset-btn" onclick="setGalleryPreset('natural')">Natural</button>
            </div>
        </div>
    </div>

    <div class="scene-info">
        <div>FPS: <span id="fps">60</span></div>
        <div>Polygons: <span id="polygons">6,234</span></div>
        <div>Materials: <span id="materials">15</span></div>
        <div>Textures: <span id="textures">12</span></div>
        <div>Lights: <span id="lights">8</span></div>
    </div>

    <div class="exhibition-info">
        <h4>Current Exhibition</h4>
        <div class="exhibition-detail">
            <span class="detail-label">Theme:</span>
            <span id="exhibitionTheme">Classical Art</span>
        </div>
        <div class="exhibition-detail">
            <span class="detail-label">Artworks:</span>
            <span id="artworkCount">6 pieces</span>
        </div>
        <div class="exhibition-detail">
            <span class="detail-label">Frame Style:</span>
            <span id="frameStyle">Gold Leaf</span>
        </div>
        <div class="exhibition-detail">
            <span class="detail-label">Lighting:</span>
            <span id="lightingType">Spotlight</span>
        </div>
        
        <div class="artwork-count">
            <div class="count-item">
                <div class="count-number" id="paintingsCount">4</div>
                <div>Paintings</div>
            </div>
            <div class="count-item">
                <div class="count-number" id="sculpturesCount">0</div>
                <div>Sculptures</div>
            </div>
            <div class="count-item">
                <div class="count-number" id="installationsCount">0</div>
                <div>Installations</div>
            </div>
        </div>
    </div>

    <script src="../../dist/umd/9th.js"></script>
    <script>
        // Global variables
        let scene, camera, renderer, gallery, animationId;
        let spotlight1, spotlight2, spotlight3, ambientLight, fillLight, galleryLight;
        let wallMaterial, floorMaterial, frameMaterial, artworkMaterial;
        let currentExhibition = 'classical', currentFrame = 'gold', currentLighting = 'spotlight';
        let selectedArtworks = new Set(['painting-1', 'painting-2', 'painting-3', 'painting-4', 'painting-5', 'painting-6']);
        
        const stats = {
            fps: 0,
            frameCount: 0,
            lastTime: performance.now()
        };

        // Exhibition definitions
        const exhibitionTypes = {
            classical: { 
                name: 'Classical Art', 
                artworks: ['painting-1', 'painting-2', 'painting-3'], 
                sculptures: [],
                installations: []
            },
            modern: { 
                name: 'Modern Art', 
                artworks: ['painting-4', 'painting-5', 'painting-6'], 
                sculptures: [],
                installations: []
            },
            contemporary: { 
                name: 'Contemporary Art', 
                artworks: ['painting-1', 'painting-4', 'painting-5'], 
                sculptures: [],
                installations: ['installation-1']
            },
            abstract: { 
                name: 'Abstract Art', 
                artworks: ['painting-4', 'painting-6'], 
                sculptures: ['sculpture-1', 'sculpture-2'],
                installations: []
            },
            impressionist: { 
                name: 'Impressionist', 
                artworks: ['painting-2', 'painting-3', 'painting-5'], 
                sculptures: [],
                installations: []
            },
            sculpture: { 
                name: 'Sculpture Garden', 
                artworks: [], 
                sculptures: ['sculpture-1', 'sculpture-2', 'sculpture-3'],
                installations: ['installation-1']
            }
        };

        // Frame materials
        const frameMaterials = {
            gold: { color: 0xFFD700, metalness: 1.0, roughness: 0.1 },
            silver: { color: 0xC0C0C0, metalness: 1.0, roughness: 0.2 },
            wood: { color: 0x8B4513, metalness: 0.0, roughness: 0.6 },
            black: { color: 0x000000, metalness: 0.1, roughness: 0.3 },
            white: { color: 0xFFFFFF, metalness: 0.0, roughness: 0.2 },
            ornate: { color: 0xDAA520, metalness: 0.8, roughness: 0.3 }
        };

        // Initialize the application
        function init() {
            const canvas = document.getElementById('canvas');
            
            // Create scene
            scene = new Ninth.Scene();
            scene.background = new Ninth.Color(0xf5f5dc);

            // Create camera
            camera = new Ninth.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 2, 8);
            camera.lookAt(0, 2, 0);

            // Create renderer
            renderer = new Ninth.WebGLRenderer({ 
                canvas: canvas, 
                antialias: true,
                alpha: true 
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = Ninth.PCFSoftShadowMap;
            renderer.toneMapping = Ninth.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.0;
            renderer.outputEncoding = Ninth.sRGBEncoding;

            // Setup lighting
            setupLighting();

            // Create gallery
            createGallery();

            // Setup controls
            setupControls();

            // Start animation loop
            animate();
        }

        function setupLighting() {
            // Main spotlights
            spotlight1 = new Ninth.SpotLight(0xffffff, 1.0, 30, Math.PI / 6, 0.3, 1);
            spotlight1.position.set(-4, 5, 2);
            spotlight1.target.position.set(-3, 2, -2);
            spotlight1.castShadow = true;
            spotlight1.shadow.mapSize.width = 1024;
            spotlight1.shadow.mapSize.height = 1024;
            scene.add(spotlight1);
            scene.add(spotlight1.target);

            spotlight2 = new Ninth.SpotLight(0xffffff, 1.0, 30, Math.PI / 6, 0.3, 1);
            spotlight2.position.set(0, 5, 2);
            spotlight2.target.position.set(0, 2, -2);
            spotlight2.castShadow = true;
            scene.add(spotlight2);
            scene.add(spotlight2.target);

            spotlight3 = new Ninth.SpotLight(0xffffff, 1.0, 30, Math.PI / 6, 0.3, 1);
            spotlight3.position.set(4, 5, 2);
            spotlight3.target.position.set(3, 2, -2);
            spotlight3.castShadow = true;
            scene.add(spotlight3);
            scene.add(spotlight3.target);

            // Ambient light
            ambientLight = new Ninth.AmbientLight(0xfff8dc, 0.3);
            scene.add(ambientLight);

            // Fill light
            fillLight = new Ninth.DirectionalLight(0xffffff, 0.2);
            fillLight.position.set(0, 4, 5);
            scene.add(fillLight);

            // Gallery ambient glow
            galleryLight = new Ninth.PointLight(0xfff8dc, 0.15, 25);
            galleryLight.position.set(0, 6, 0);
            scene.add(galleryLight);
        }

        function createGallery() {
            // Remove existing gallery
            if (gallery) {
                scene.remove(gallery);
            }

            // Create gallery group
            gallery = new Ninth.Group();

            // Create materials
            createMaterials();

            // Create gallery space
            createGallerySpace();

            // Add artworks
            addArtworks();

            // Position gallery
            gallery.position.y = 0;
            scene.add(gallery);

            updateStats();
            updateExhibitionInfo();
        }

        function createMaterials() {
            // Wall material
            wallMaterial = new Ninth.MeshStandardMaterial({
                color: 0xF5F5DC,
                roughness: 0.8,
                metalness: 0.0
            });

            // Floor material
            floorMaterial = new Ninth.MeshStandardMaterial({
                color: 0x8B7355,
                roughness: 0.6,
                metalness: 0.1
            });

            // Frame material
            const frameProps = frameMaterials[currentFrame];
            frameMaterial = new Ninth.MeshStandardMaterial({
                color: frameProps.color,
                metalness: frameProps.metalness,
                roughness: frameProps.roughness
            });

            // Artwork material
            artworkMaterial = new Ninth.MeshStandardMaterial({
                color: 0x4169E1,
                roughness: 0.4,
                metalness: 0.0
            });
        }

        function createGallerySpace() {
            // Gallery walls
            createGalleryWalls();

            // Gallery floor
            createGalleryFloor();

            // Gallery ceiling
            createGalleryCeiling();

            // Pedestals for sculptures
            createPedestals();

            // Gallery furniture
            createGalleryFurniture();
        }

        function createGalleryWalls() {
            // Back wall
            const backWallGeometry = new Ninth.PlaneGeometry(16, 6);
            const backWall = new Ninth.Mesh(backWallGeometry, wallMaterial);
            backWall.position.set(0, 3, -6);
            backWall.receiveShadow = true;
            gallery.add(backWall);

            // Left wall
            const leftWallGeometry = new Ninth.PlaneGeometry(12, 6);
            const leftWall = new Ninth.Mesh(leftWallGeometry, wallMaterial);
            leftWall.position.set(-8, 3, 0);
            leftWall.rotation.y = Math.PI / 2;
            leftWall.receiveShadow = true;
            gallery.add(leftWall);

            // Right wall
            const rightWallGeometry = new Ninth.PlaneGeometry(12, 6);
            const rightWall = new Ninth.Mesh(rightWallGeometry, wallMaterial);
            rightWall.position.set(8, 3, 0);
            rightWall.rotation.y = -Math.PI / 2;
            rightWall.receiveShadow = true;
            gallery.add(rightWall);

            // Front wall (partial)
            const frontWallGeometry = new Ninth.PlaneGeometry(16, 6);
            const frontWall = new Ninth.Mesh(frontWallGeometry, wallMaterial);
            frontWall.position.set(0, 3, 6);
            frontWall.rotation.y = Math.PI;
            frontWall.receiveShadow = true;
            gallery.add(frontWall);
        }

        function createGalleryFloor() {
            const floorGeometry = new Ninth.PlaneGeometry(16, 12);
            const floor = new Ninth.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.position.y = 0;
            floor.receiveShadow = true;
            gallery.add(floor);

            // Add subtle pattern
            for (let i = 0; i < 4; i++) {
                const patternGeometry = new Ninth.PlaneGeometry(15.5, 2.8);
                const patternMaterial = new Ninth.MeshStandardMaterial({
                    color: 0xA0826D,
                    roughness: 0.7,
                    metalness: 0.0
                });
                const pattern = new Ninth.Mesh(patternGeometry, patternMaterial);
                pattern.rotation.x = -Math.PI / 2;
                pattern.position.y = 0.001;
                pattern.position.z = -2 + i * 1.5;
                pattern.receiveShadow = true;
                gallery.add(pattern);
            }
        }

        function createGalleryCeiling() {
            const ceilingGeometry = new Ninth.PlaneGeometry(16, 12);
            const ceilingMaterial = new Ninth.MeshStandardMaterial({
                color: 0xF5F5DC,
                roughness: 0.9,
                metalness: 0.0
            });
            const ceiling = new Ninth.Mesh(ceilingGeometry, ceilingMaterial);
            ceiling.rotation.x = Math.PI / 2;
            ceiling.position.y = 6;
            gallery.add(ceiling);
        }

        function createPedestals() {
            const pedestalPositions = [
                [-4, 0.4, 0],
                [0, 0.4, 0],
                [4, 0.4, 0]
            ];

            pedestalPositions.forEach(pos => {
                const pedestalGeometry = new Ninth.CylinderGeometry(0.3, 0.35, 0.8, 16);
                const pedestal = new Ninth.Mesh(pedestalGeometry, floorMaterial);
                pedestal.position.set(...pos);
                pedestal.castShadow = true;
                pedestal.receiveShadow = true;
                gallery.add(pedestal);
            });
        }

        function createGalleryFurniture() {
            // Seating area
            const benchGeometry = new Ninth.BoxGeometry(2, 0.1, 0.4);
            const benchMaterial = new Ninth.MeshStandardMaterial({
                color: 0x8B4513,
                roughness: 0.6,
                metalness: 0.1
            });
            
            const bench = new Ninth.Mesh(benchGeometry, benchMaterial);
            bench.position.set(0, 0.55, 3);
            bench.castShadow = true;
            gallery.add(bench);

            // Information desk
            const deskGeometry = new Ninth.BoxGeometry(1.5, 0.75, 0.8);
            const deskMaterial = new Ninth.MeshStandardMaterial({
                color: 0x654321,
                roughness: 0.5,
                metalness: 0.2
            });
            
            const desk = new Ninth.Mesh(deskGeometry, deskMaterial);
            desk.position.set(-6, 0.375, 4);
            desk.castShadow = true;
            gallery.add(desk);
        }

        function addArtworks() {
            const exhibition = exhibitionTypes[currentExhibition];
            
            // Add paintings
            selectedArtworks.forEach(artworkId => {
                if (exhibition.artworks.includes(artworkId)) {
                    createPainting(artworkId);
                }
            });

            // Add sculptures
            exhibition.sculptures.forEach(sculptureId => {
                createSculpture(sculptureId);
            });

            // Add installations
            exhibition.installations.forEach(installationId => {
                createInstallation(installationId);
            });
        }

        function createPainting(artworkId) {
            const paintingGroup = new Ninth.Group();
            
            const artwork = exhibitionTypes[currentExhibition].artworks.find(a => a === artworkId);
            if (!artwork) return;

            // Frame
            const frameGeometry = new Ninth.BoxGeometry(1.4, 1.0, 0.1);
            const frame = new Ninth.Mesh(frameGeometry, frameMaterial);
            frame.castShadow = true;
            paintingGroup.add(frame);

            // Canvas
            const canvasGeometry = new Ninth.PlaneGeometry(1.2, 0.8);
            const canvasColors = {
                'painting-1': 0x8B4513, // Portrait - brown skin tones
                'painting-2': 0x228B22, // Landscape - green
                'painting-3': 0xDC143C, // Still life - red
                'painting-4': 0x4169E1, // Abstract - blue
                'painting-5': 0xFF6347, // Seascape - coral
                'painting-6': 0x800080  // Cityscape - purple
            };

            const canvasMaterial = new Ninth.MeshStandardMaterial({
                color: canvasColors[artworkId] || 0x4169E1,
                roughness: 0.3,
                metalness: 0.0
            });
            
            const canvas = new Ninth.Mesh(canvasGeometry, canvasMaterial);
            canvas.position.z = 0.06;
            paintingGroup.add(canvas);

            // Mounting wire
            const wireGeometry = new Ninth.CylinderGeometry(0.01, 0.01, 1.0);
            const wireMaterial = new Ninth.MeshStandardMaterial({ color: 0x444444, roughness: 0.4 });
            const wire = new Ninth.Mesh(wireGeometry, wireMaterial);
            wire.rotation.z = Math.PI / 2;
            wire.position.y = 0.6;
            paintingGroup.add(wire);

            // Position based on artwork ID
            const positions = {
                'painting-1': [-5, 2.5, -5.9],
                'painting-2': [-3, 2.5, -5.9],
                'painting-3': [-1, 2.5, -5.9],
                'painting-4': [1, 2.5, -5.9],
                'painting-5': [3, 2.5, -5.9],
                'painting-6': [5, 2.5, -5.9]
            };

            const position = positions[artworkId] || [0, 2.5, -5.9];
            paintingGroup.position.set(...position);
            gallery.add(paintingGroup);
        }

        function createSculpture(sculptureId) {
            const sculptureGroup = new Ninth.Group();
            
            let sculptureGeometry, sculptureMaterial;
            
            if (sculptureId === 'sculpture-1') {
                // Classical bust
                sculptureGeometry = new Ninth.CylinderGeometry(0.15, 0.2, 0.6, 16);
                sculptureMaterial = new Ninth.MeshStandardMaterial({
                    color: 0xF5F5DC,
                    roughness: 0.3,
                    metalness: 0.0
                });
            } else if (sculptureId === 'sculpture-2') {
                // Modern abstract
                sculptureGeometry = new Ninth.BoxGeometry(0.3, 0.8, 0.3);
                sculptureMaterial = new Ninth.MeshStandardMaterial({
                    color: 0x708090,
                    roughness: 0.4,
                    metalness: 0.6
                });
            } else if (sculptureId === 'sculpture-3') {
                // Sphere sculpture
                sculptureGeometry = new Ninth.SphereGeometry(0.25, 16, 12);
                sculptureMaterial = new Ninth.MeshStandardMaterial({
                    color: 0xFFD700,
                    roughness: 0.1,
                    metalness: 1.0
                });
            }

            const sculpture = new Ninth.Mesh(sculptureGeometry, sculptureMaterial);
            sculpture.position.y = 0.8;
            sculpture.castShadow = true;
            sculptureGroup.add(sculpture);

            const positions = {
                'sculpture-1': [-4, 0, 0],
                'sculpture-2': [0, 0, 0],
                'sculpture-3': [4, 0, 0]
            };

            const position = positions[sculptureId] || [0, 0, 0];
            sculptureGroup.position.set(...position);
            gallery.add(sculptureGroup);
        }

        function createInstallation(installationId) {
            if (installationId === 'installation-1') {
                // Contemporary installation
                const columns = [];
                for (let i = 0; i < 5; i++) {
                    const columnGeometry = new Ninth.CylinderGeometry(0.05, 0.05, 2 + Math.random(), 8);
                    const columnMaterial = new Ninth.MeshStandardMaterial({
                        color: 0xE6E6FA,
                        roughness: 0.2,
                        metalness: 0.1,
                        transparent: true,
                        opacity: 0.8
                    });
                    const column = new Ninth.Mesh(columnGeometry, columnMaterial);
                    column.position.set(-3 + i * 1.5, 1 + (i % 2) * 0.5, 2);
                    column.castShadow = true;
                    columns.push(column);
                    gallery.add(column);
                }

                // Connecting elements
                for (let i = 0; i < 4; i++) {
                    const bridgeGeometry = new Ninth.BoxGeometry(1.4, 0.02, 0.02);
                    const bridgeMaterial = new Ninth.MeshStandardMaterial({
                        color: 0xDDA0DD,
                        roughness: 0.3,
                        metalness: 0.2
                    });
                    const bridge = new Ninth.Mesh(bridgeGeometry, bridgeMaterial);
                    bridge.position.set(-3.75 + i * 1.5, 2.5, 2);
                    bridge.castShadow = true;
                    gallery.add(bridge);
                }
            }
        }

        function setupControls() {
            // Exhibition type buttons
            document.querySelectorAll('.exhibition-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.exhibition-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentExhibition = this.dataset.exhibition;
                    updateArtworkGrid();
                    createGallery();
                });
            });

            // Frame style buttons
            document.querySelectorAll('.frame-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.frame-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFrame = this.dataset.frame;
                    createGallery();
                });
            });

            // Lighting buttons
            document.querySelectorAll('.lighting-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.lighting-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentLighting = this.dataset.lighting;
                    updateLightingSetup();
                });
            });

            // Artwork buttons
            document.querySelectorAll('.artwork-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const artworkId = this.dataset.artwork;
                    this.classList.toggle('active');
                    
                    if (this.classList.contains('active')) {
                        selectedArtworks.add(artworkId);
                    } else {
                        selectedArtworks.delete(artworkId);
                    }
                    
                    createGallery();
                    updateExhibitionInfo();
                });
            });

            // Lighting controls
            const lightControls = [
                { id: 'spotlightIntensity', obj: spotlight1, valueId: 'spotlightValue', suffix: '%' },
                { id: 'ambientIntensity', obj: ambientLight, valueId: 'ambientValue', suffix: '%' },
                { id: 'fillIntensity', obj: fillLight, valueId: 'fillValue', suffix: '%' },
                { id: 'galleryIntensity', obj: galleryLight, valueId: 'galleryValue', suffix: '%' }
            ];

            lightControls.forEach(control => {
                const element = document.getElementById(control.id);
                const valueElement = document.getElementById(control.valueId);
                
                element.addEventListener('input', function() {
                    const value = parseFloat(this.value);
                    control.obj.intensity = value / 100;
                    valueElement.textContent = value + control.suffix;
                });
            });
        }

        function updateArtworkGrid() {
            const exhibition = exhibitionTypes[currentExhibition];
            const artworkGrid = document.getElementById('artworkGrid');
            
            // Reset grid
            artworkGrid.innerHTML = '';
            
            // Add available artworks
            exhibition.artworks.forEach(artworkId => {
                const button = document.createElement('div');
                button.className = 'artwork-btn' + (selectedArtworks.has(artworkId) ? ' active' : '');
                button.dataset.artwork = artworkId;
                button.textContent = artworkId.split('-')[1];
                
                // Add event listener
                button.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const artId = this.dataset.artwork;
                    
                    if (this.classList.contains('active')) {
                        selectedArtworks.add(artId);
                    } else {
                        selectedArtworks.delete(artId);
                    }
                    
                    createGallery();
                    updateExhibitionInfo();
                });
                
                artworkGrid.appendChild(button);
            });
        }

        function updateLightingSetup() {
            const presets = {
                spotlight: { spot: 100, ambient: 30, fill: 20, gallery: 15 },
                track: { spot: 80, ambient: 50, fill: 40, gallery: 25 },
                natural: { spot: 60, ambient: 70, fill: 50, gallery: 35 },
                ambient: { spot: 40, ambient: 80, fill: 60, gallery: 40 }
            };

            const p = presets[currentLighting];
            if (p) {
                document.getElementById('spotlightIntensity').value = p.spot;
                document.getElementById('ambientIntensity').value = p.ambient;
                document.getElementById('fillIntensity').value = p.fill;
                document.getElementById('galleryIntensity').value = p.gallery;
                
                spotlight1.intensity = p.spot / 100;
                spotlight2.intensity = p.spot / 100;
                spotlight3.intensity = p.spot / 100;
                ambientLight.intensity = p.ambient / 100;
                fillLight.intensity = p.fill / 100;
                galleryLight.intensity = p.gallery / 100;
                
                document.getElementById('spotlightValue').textContent = p.spot + '%';
                document.getElementById('ambientValue').textContent = p.ambient + '%';
                document.getElementById('fillValue').textContent = p.fill + '%';
                document.getElementById('galleryValue').textContent = p.gallery + '%';
            }
        }

        function updateExhibitionInfo() {
            const exhibition = exhibitionTypes[currentExhibition];
            
            document.getElementById('exhibitionTheme').textContent = exhibition.name;
            document.getElementById('artworkCount').textContent = `${selectedArtworks.size} pieces`;
            document.getElementById('frameStyle').textContent = currentFrame.charAt(0).toUpperCase() + currentFrame.slice(1) + ' Frame';
            document.getElementById('lightingType').textContent = currentLighting.charAt(0).toUpperCase() + currentLighting.slice(1);
            
            document.getElementById('paintingsCount').textContent = selectedArtworks.size;
            document.getElementById('sculpturesCount').textContent = exhibition.sculptures.length;
            document.getElementById('installationsCount').textContent = exhibition.installations.length;
        }

        function setGalleryPreset(preset) {
            const presets = {
                museum: { spot: 100, ambient: 30, fill: 20, gallery: 15 },
                intimate: { spot: 60, ambient: 60, fill: 40, gallery: 35 },
                dramatic: { spot: 150, ambient: 10, fill: 15, gallery: 5 },
                natural: { spot: 70, ambient: 80, fill: 50, gallery: 30 }
            };

            const p = presets[preset];
            if (p) {
                document.getElementById('spotlightIntensity').value = p.spot;
                document.getElementById('ambientIntensity').value = p.ambient;
                document.getElementById('fillIntensity').value = p.fill;
                document.getElementById('galleryIntensity').value = p.gallery;
                
                spotlight1.intensity = p.spot / 100;
                spotlight2.intensity = p.spot / 100;
                spotlight3.intensity = p.spot / 100;
                ambientLight.intensity = p.ambient / 100;
                fillLight.intensity = p.fill / 100;
                galleryLight.intensity = p.gallery / 100;
                
                document.getElementById('spotlightValue').textContent = p.spot + '%';
                document.getElementById('ambientValue').textContent = p.ambient + '%';
                document.getElementById('fillValue').textContent = p.fill + '%';
                document.getElementById('galleryValue').textContent = p.gallery + '%';
            }
        }

        function updateStats() {
            document.getElementById('materials').textContent = '15';
            document.getElementById('textures').textContent = '12';
            document.getElementById('lights').textContent = '8';
            document.getElementById('polygons').textContent = '6,234';
        }

        function animate() {
            animationId = requestAnimationFrame(animate);

            // Update FPS counter
            const now = performance.now();
            stats.frameCount++;
            
            if (now - stats.lastTime >= 1000) {
                stats.fps = Math.round((stats.frameCount * 1000) / (now - stats.lastTime));
                document.getElementById('fps').textContent = stats.fps;
                stats.frameCount = 0;
                stats.lastTime = now;
            }

            // Gentle camera movement for gallery tour
            if (gallery) {
                const time = Date.now() * 0.0005;
                camera.position.x = Math.sin(time) * 2;
                camera.position.z = 8 + Math.cos(time * 0.7) * 1;
                camera.lookAt(0, 2, 0);
            }

            // Render
            renderer.render(scene, camera);
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>